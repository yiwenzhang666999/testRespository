define(["map","drawBufferMap","publicObj"],function(c,i,e){var l;var f;var g;var h;var d;function b(n,m){if(n==f){return}if(n){d=m;if(!h){h=c.getMap()}if(!g){g=c.getLayerByName("HIGH_LAYER")}a();i.draw("Polygon",k)}else{if(g&&l&&g.getSource().getFeatures()>0){g.getSource().clear()}l=null;i.clear()}f=n}function j(){i.removeLastPoint()}function k(m){l=m.feature.clone();l.setStyle(e.addStyle);g.getSource().addFeature(l);d("add",m.feature,templates[0])}function a(){$("#map").removeClass("Track");$("#map").removeClass("noTrack");$("#map").addClass("noTrack")}return{setActive:b,undo:j}});