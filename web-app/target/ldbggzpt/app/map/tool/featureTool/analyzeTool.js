define(["map","queryLayer"],function(g,a){var f;var d=new ol.format.WKT();function h(i){f=g.getMap()}function e(j){var i={};if(j){var l=j.getProperties();if(l){i.fid=l.ID}}var k={callback:function(n){var o=typeof n=="object"?n:JSON.parse(n);var m=c(o);var p=$().iBox({title:"叠加分析报告&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; 单位（公顷）",requestType:"html",html:m||"",containerId:"containerId_ibox",showMin:false,overlay:true,opacity:0.5,callBack:function(){$(".zs-nicescroll").niceScroll({cursorcolor:"#777",cursorborder:"none",});$(".close-button").on("click",function(){$(".ibox-close").click()})}});p.showBox()},exceptionHandler:function(m){}};b("",JSON.stringify(i),k)}function c(u){var k="<form id='popIbox_analyze' style='width:400px'><table class='fore-common-form-tabs'>";var n=u.DI_LEI;var q=0;if(JSON.stringify(n)!="{}"){var r="";var j="";var p=0;for(var t in n){var o=n[t];if("0.00"!=o.toFixed(2)){p+=parseFloat(o);if((t.replace(/(^\s*)|(\s*$)/g,""))==""){j+="<tr><td></td><td>"+(t.replace(/(^\s*)|(\s*$)/g,"")==""?"-":t)+"</td><td>"+o.toFixed(2)+"</td></tr>"}else{r+="<tr><td></td><td>"+(t.replace(/(^\s*)|(\s*$)/g,"")==""?"-":t)+"</td><td>"+o.toFixed(2)+"</td></tr>"}}}if("0.00"!=p.toFixed(2)){k+="<tr><td style='font-weight:bold;'>地类</td><td style='font-weight:bold;'>合计</td><td style='font-weight:bold;'>"+p.toFixed(2)+"</td></tr>"}k+=r;k+=j;q++}var s=u.QI_YUAN;if(JSON.stringify(s)!="{}"){var m="";var j="";var p=0;for(var t in s){var o=s[t];if("0.00"!=o.toFixed(2)){p+=parseFloat(o);if((t.replace(/(^\s*)|(\s*$)/g,""))==""){j+="<tr><td></td><td>"+(t.replace(/(^\s*)|(\s*$)/g,"")==""?"-":t)+"</td><td>"+o.toFixed(2)+"</td></tr>"}else{m+="<tr><td></td><td>"+(t.replace(/(^\s*)|(\s*$)/g,"")==""?"-":t)+"</td><td>"+o.toFixed(2)+"</td></tr>"}}}if("0.00"!=p.toFixed(2)){k+="<tr><td style='font-weight:bold;'>起源</td><td style='font-weight:bold;'>合计</td><td style='font-weight:bold;'>"+p.toFixed(2)+"</td></tr>"}k+=m;k+=j;q++}var i=u.SEN_LIN_LB;if(JSON.stringify(i)!="{}"){var l="";var j="";var p=0;for(var t in i){var o=i[t];if("0.00"!=o.toFixed(2)){p+=parseFloat(o);if((t.replace(/(^\s*)|(\s*$)/g,""))==""){j+="<tr><td></td><td>"+(t.replace(/(^\s*)|(\s*$)/g,"")==""?"-":t)+"</td><td>"+o.toFixed(2)+"</td></tr>"}else{l+="<tr><td></td><td>"+(t.replace(/(^\s*)|(\s*$)/g,"")==""?"-":t)+"</td><td>"+o.toFixed(2)+"</td></tr>"}}}if("0.00"!=p.toFixed(2)){k+="<tr><td style='font-weight:bold;'>森林类别</td><td style='font-weight:bold;'>合计</td><td style='font-weight:bold;'>"+p.toFixed(2)+"</td></tr>"}k+=l;k+=j;q++}if(q==0){k+="<tr><td>分析结果无数据.</td></tr>"}k+="</table></form>";return k}function b(j,i,k){$.ajax({url:"analyze/execute.web",data:{data:i},type:"post",cache:false,success:function(l){if(l.result=="success"){k.callback(l.data)}},error:function(l){if(l.responseText=="timeout"){window.location.href="login.do"}else{k.exceptionHandler(l)}}})}return{init:h,execute:e}});