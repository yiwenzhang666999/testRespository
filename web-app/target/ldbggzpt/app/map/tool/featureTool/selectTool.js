define(["map","publicObj","queryLayer","ztLayerCro","shdk"],function(b,e,c,j,d){var i;var l;var h;var k;var f=null;function a(n,m){if(n==f){return}if(n){i=b.getMap();if(!h){h=b.getLayerByName("HIGH_LAYER")}if(k){k.setActive(n)}else{k=new ol.interaction.Select({layers:function(o){var p=e.getLayers();return p.indexOf(o)>=0},style:e.defaultStyle});i.addInteraction(k);k.on("select",function(s){if(s.selected&&s.selected.length>0){var r=s.selected[0];if($(".tool-sh").hasClass("selected")){for(var q=0;q<e.features.length;q++){var p=e.features[q].getProperties().C_STATUS+"";e.features[q].setStyle(e.shStyleObj[p])}if(h&&e.features&&h.getSource().getFeatures().length>0){for(var q=0;q<e.features.length;q++){h.getSource().clear()}}e.features=[];e.features.push(r);r.setStyle(e.selectStyle);h.getSource().addFeature(r);d.getDataById(r.getProperties().ID,r.getProperties().C_XIAN)}else{var o=true;for(var q=0;q<e.features.length;q++){if(e.features[q].getProperties().ID==r.getProperties().ID){o=false;var p=r.getProperties().C_STATUS+"";r.setStyle(e.shStyleObj[p]);h.getSource().removeFeature(r);e.features.splice(q,1);break}}if(o){e.features.push(r);r.setStyle(e.selectStyle);h.getSource().addFeature(r)}if(typeof m=="function"){m(r)}}}})}}else{if(i){k.setActive(n)}}f=n}function g(){if(i&&k){k.setActive(false);i.removeInteraction(k)}for(var n=0;n<e.features.length;n++){var m=e.features[n].getProperties().C_STATUS+"";e.features[n].setStyle(e.shStyleObj[m])}if(h){h.getSource().clear()}e.features=[];k=null;f=false}ol.interaction.Select.handleEvent=function(n){if(!this.condition_(n)){return true}var x=this.addCondition_(n);var t=this.removeCondition_(n);var u=this.toggleCondition_(n);var w=!x&&!t&&!u;var m=n.map;var o=this.featureOverlay_.getSource().getFeaturesCollection();var p=[];var r=[];if(w){ol.obj.clear(this.featureLayerAssociation_);m.forEachFeatureAtPixel(n.pixel,(function(A,z){if(this.filter_(A,z)){r.push(A);this.addFeatureLayerAssociation_(A,z);return !this.multi_}}).bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});var s;for(s=o.getLength()-1;s>=0;--s){var y=o.item(s);var v=r.indexOf(y);o.remove(y);p.push(y)}if(r.length!==0){o.extend(r)}}else{m.forEachFeatureAtPixel(n.pixel,(function(A,z){if(this.filter_(A,z)){if((x||u)&&!ol.array.includes(o.getArray(),A)){r.push(A);this.addFeatureLayerAssociation_(A,z)}else{if((t||u)&&ol.array.includes(o.getArray(),A)){p.push(A);this.removeFeatureLayerAssociation_(A)}}return !this.multi_}}).bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});var q;for(q=p.length-1;q>=0;--q){o.remove(p[q])}o.extend(r)}if(r.length>0||p.length>0){this.dispatchEvent(new ol.interaction.Select.Event(ol.interaction.Select.EventType_.SELECT,r,p,n))}return ol.events.condition.pointerMove(n)};return{setActive:a,clear:g}});